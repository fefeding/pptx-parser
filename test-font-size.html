<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>字体大小测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .test-result {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
        }
        pre {
            white-space: pre-wrap;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <h1>字体大小解析测试</h1>
    <div id="test-result" class="test-result"></div>

    <script src="./dist/ppt-parser.browser.js"></script>
    <script>
        // 测试字体大小解析
        async function testFontSize() {
            try {
                // 使用示例 PPTX 文件
                const fileInput = document.createElement('input');
                fileInput.type = 'file';
                fileInput.accept = '.pptx';
                
                // 模拟文件选择
                // 注意：在浏览器中，需要用户手动选择文件
                // 这里我们只是展示测试方法
                
                document.getElementById('test-result').innerHTML = `
                    <h2>测试说明</h2>
                    <p>此测试页面用于验证 PPTX 字体大小解析是否正确。</p>
                    <p>修复内容：</p>
                    <ul>
                        <li>修改了 shape.js 中的类型处理逻辑，保持原始类型（body、obj）不变，而不是强制设置为 shape</li>
                        <li>这样在解析字体大小时，会正确继承相应类型的样式定义</li>
                        <li>例如，body 类型会使用 bodyStyle 中的字体大小，而不是 otherStyle 中的字体大小</li>
                    </ul>
                    <h2>预期结果</h2>
                    <p>对于示例文件 "金腾研发架构&系统介绍.pptx"：</p>
                    <ul>
                        <li>标题文本（类型为 body）的字体大小应该接近 48px</li>
                        <li>日期文本（类型为 obj）的字体大小应该接近 16px</li>
                    </ul>
                `;
            } catch (error) {
                document.getElementById('test-result').innerHTML = `<h2>测试错误</h2><p>${error.message}</p>`;
            }
        }

        // 运行测试
        testFontSize();
    </script>
</body>
</html>