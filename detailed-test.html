<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Detailed Module Test</title>

<script type="text/javascript" src="./src/js/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="./src/js/jszip.min.js"></script>
<script type="text/javascript" src="./src/js/filereader.js"></script>

<script>
$(function() {
    console.log('=== 开始详细模块测试 ===');
    
    // 测试每个模块文件是否能正确加载
    const moduleFiles = [
        './src/js/modules/utils/tXml.js',
        './src/js/modules/utils/file-utils.js',
        './src/js/modules/utils/color-utils.js',
        './src/js/modules/utils/image-utils.js',
        './src/js/modules/utils/text-utils.js',
        './src/js/modules/utils/xml-utils.js',
        './src/js/modules/utils/chart-utils.js',
        './src/js/modules/core/constants.js'
    ];
    
    moduleFiles.forEach(file => {
        console.log(`正在测试: ${file}`);
        try {
            // 创建script标签动态加载
            const script = document.createElement('script');
            script.src = file;
            script.onload = function() {
                console.log(`✓ ${file} 加载成功`);
            };
            script.onerror = function() {
                console.error(`✗ ${file} 加载失败`);
            };
            document.head.appendChild(script);
        } catch (e) {
            console.error(`✗ ${file} 加载异常:`, e.message);
        }
    });
    
    // 等待一段时间后检查全局变量
    setTimeout(() => {
        console.log('\n=== 检查全局变量 ===');
        
        const modules = [
            'PPTXFileUtils',
            'PPTXColorUtils', 
            'PPTXImageUtils',
            'PPTXTextUtils',
            'PPTXXmlUtils',
            'PPTXChartUtils',
            'PPTXConstants'
        ];
        
        modules.forEach(module => {
            if (window[module]) {
                console.log(`✓ ${module} 可用`);
                
                // 检查主要函数
                if (module === 'PPTXFileUtils') {
                    const funcs = ['findMediaFile', 'resolveMediaPath', 'readXmlFile'];
                    funcs.forEach(func => {
                        if (typeof window[module][func] === 'function') {
                            console.log(`  ✓ ${module}.${func} 可用`);
                        } else {
                            console.error(`  ✗ ${module}.${func} 不可用`);
                        }
                    });
                }
            } else {
                console.error(`✗ ${module} 不可用`);
            }
        });
        
        // 测试具体的函数调用
        console.log('\n=== 测试函数调用 ===');
        if (window.PPTXFileUtils && typeof window.PPTXFileUtils.findMediaFile === 'function') {
            console.log('✓ PPTXFileUtils.findMediaFile 函数可调用');
        } else {
            console.error('✗ PPTXFileUtils.findMediaFile 函数不可调用');
        }
        
    }, 2000); // 等待2秒让所有脚本加载完成
    
});
</script>

</head>
<body>
    <h1>详细模块加载测试</h1>
    <p>请打开浏览器开发者工具查看控制台输出。</p>
</body>
</html>