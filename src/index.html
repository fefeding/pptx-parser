<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>PPTXjs - Meshesha</title>

<link rel="stylesheet" href="./css/pptxjs.css">

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="./js/jszip.min.js"></script>
    <script type="text/javascript" src="./js/utils/jszip-utils.js"></script>
    <script type="text/javascript" src="./js/txml.js"></script>
    <script type="text/javascript" src="./js/tinycolor.js"></script>
    <script type="text/javascript" src="./js/filereader.js"></script>
    <script type="text/javascript" src="./js/utils/utils.js"></script>
    <script type="text/javascript" src="./js/utils/pptx-color-utils.js"></script>
    <script type="text/javascript" src="./js/utils/pptx-shape-utils.js"></script>
    <script type="text/javascript" src="./js/utils/pptx-shape-fills-utils.js"></script>
    <script type="text/javascript" src="./js/utils/pptx-ui-utils.js"></script>
    <script type="text/javascript" src="./js/pptx-parser.js"></script>
    <script type="text/javascript" src="./js/pptx-html.js"></script>
    <script type="text/javascript" src="./js/pptxjs.js"></script>

<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
		var oldWidth, oldMargin, isFullscreenMode = false;
		var fullscreenBtn = document.getElementById('fullscreen-btn');
		var resultDiv = document.getElementById('result');
		
		fullscreenBtn.addEventListener('click', function(){
			if (!isFullscreenMode) {
				var slides = document.querySelectorAll('#result .slide');
				if (slides.length > 0) {
					oldWidth = window.getComputedStyle(slides[0]).width;
					oldMargin = window.getComputedStyle(slides[0]).margin;
				}
				slides.forEach(function(slide) {
					slide.style.width = '99%';
					slide.style.margin = '0 auto';
				});
				if (resultDiv.requestFullscreen) {
					resultDiv.requestFullscreen();
				} else if (resultDiv.mozRequestFullScreen) {
					resultDiv.mozRequestFullScreen();
				} else if (resultDiv.webkitRequestFullscreen) {
					resultDiv.webkitRequestFullscreen();
				} else if (resultDiv.msRequestFullscreen) {
					resultDiv.msRequestFullscreen();
				}
				isFullscreenMode = true;
			} else {
				var slides = document.querySelectorAll('#result .slide');
				slides.forEach(function(slide) {
					slide.style.width = oldWidth;
					slide.style.margin = oldMargin;
				});
				if (document.exitFullscreen) {
					document.exitFullscreen();
				} else if (document.mozCancelFullScreen) {
					document.mozCancelFullScreen();
				} else if (document.webkitExitFullscreen) {
					document.webkitExitFullscreen();
				} else if (document.msExitFullscreen) {
					document.msExitFullscreen();
				}
				isFullscreenMode = false;
			}
		});
		
		document.addEventListener('fullscreenchange', function() {
			if (!document.fullscreenElement) {
				var slides = document.querySelectorAll('#result .slide');
				slides.forEach(function(slide) {
					slide.style.width = oldWidth;
					slide.style.margin = oldMargin;
				});
			}
		});
    });
</script>
<style>
	html, body { margin: 0; padding: 0; }
	#warper { margin-right: auto; margin-left: auto; width: 900px; }
</style>
</head>
<body>
	<div id="warper">
		<input id="uploadFileInput" type="file" />
		<br><br>
		<div id="container">
			<input id="fullscreen-btn" type="button" value="Fullscreen" />
			<br>
			<div  id="result"></div>
		</div>
	</div>
<script>
pptxToHtml(document.getElementById('result'), {
	fileInputId: "uploadFileInput",
	slideMode: false,
	keyBoardShortCut: false,
	slideModeConfig: {  //on slide mode (slideMode: true)
	    first: 1, 
	    nav: false, /** true,false : show or not nav buttons*/
	    navTxtColor: "white", /** color */
	    navNextTxt:"&#8250;", //">"
	    navPrevTxt: "&#8249;", //"<"
	    showPlayPauseBtn: false,/** true,false */
	    keyBoardShortCut: false, /** true,false */
	    showSlideNum: false, /** true,false */
	    showTotalSlideNum: false, /** true,false */
	    autoSlide: false, /** false or seconds (the pause time between slides) , F8 to active(keyBoardShortCut: true) */
	    randomAutoSlide: false, /** true,false ,autoSlide:true */ 
	    loop: false,  /** true,false */
	    background: "black", /** false or color*/
	    transition: "default", /** transition type: "slid","fade","default","random" , to show transition efects :transitionTime > 0.5 */
	    transitionTime: 1 /** transition time in seconds */
	}
});
</script>

</body>
</html>
